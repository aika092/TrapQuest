Ghost by Monster begins here.

A ghost is a kind of monster. A ghost is usually male. A ghost has a number called bank. The bank of a ghost is usually 120. A ghost has a number called wind-up.  The wind-up of a ghost is usually 0. A ghost is usually willing to do oral.  A ghost is usually willing to do anal.  A ghost is usually willing to do vaginal.  [A ghost is usually willing to do titfucks.] A ghost is usually mansion dwelling. A ghost is poison immune. A ghost is usually father material. A ghost can be phased or unphased.

The printed name of ghost is usually "[input-style]ghost[if the sleep of the item described > 0] (fast asleep)[end if][shortcut-desc][roman type]".  The description of ghost is usually "[GhostDesc]".  The text-shortcut of ghost is "pe". Understand "ghost", "dick", "cock", "penis" as a ghost.

A jismbodied ghost is a kind of ghost. There is 1 jismbodied ghost. The printed name of a jismbodied ghost is "[if item described is in the location of the player][TQlink of item described][end if][input-style]disembodied ghost[shortcut-desc][roman type][if item described is in the location of the player][TQxlink of item described][verb-desc of item described][end if]". The text-shortcut of jismbodied ghost is "dis".  Understand "disembodied", "jism", "dism", "jis" as jismbodied ghost. The bank of a jismbodied ghost is usually 180.

A perverted ghost is a kind of ghost. There is 1 perverted ghost. The printed name of a perverted ghost is "[if item described is in the location of the player][TQlink of item described][end if][input-style]perverted ghost[shortcut-desc][roman type][if item described is in the location of the player][TQxlink of item described][verb-desc of item described][end if]". The text-shortcut of perverted ghost is "per".
A haunty ghost is a kind of ghost. There is 1 haunty ghost. The printed name of a haunty ghost is "[if item described is in the location of the player][TQlink of item described][end if][input-style]horny ghost[shortcut-desc][roman type][if item described is in the location of the player][TQxlink of item described][verb-desc of item described][end if]". The text-shortcut of haunty ghost is "hau". Understand "horny" as haunty ghost.
A creepy ghost is a kind of ghost. There is 1 creepy ghost. The printed name of a creepy ghost is "[if item described is in the location of the player][TQlink of item described][end if][input-style]creepy ghost[shortcut-desc][roman type][if item described is in the location of the player][TQxlink of item described][verb-desc of item described][end if]". The text-shortcut of creepy ghost is "cre". 
A unsettling ghost is a kind of ghost. There is 1 unsettling ghost. The printed name of a unsettling ghost is "[if item described is in the location of the player][TQlink of item described][end if][input-style]unsettling ghost[shortcut-desc][roman type][if item described is in the location of the player][TQxlink of item described][verb-desc of item described][end if]". The text-shortcut of unsettling ghost is "uns".


Figure of ghost 1 is the file "ghost1.png".
Figure of ghost 2 is the file "ghost2.png".
Figure of ghost 3 is the file "ghost3.png".
Figure of ghost 4 is the file "ghost4.png".
 
To say GhostDesc:
	if the item described is unfriendly:
		if images visible is 1:
			if item described is jismbodied ghost, display figure of ghost 4;
			otherwise display figure of ghost 2;
		say "[if the item described is jismbodied ghost]This floating, faintly glowing penis is composed entirely of semi-solid silver slime. Even for an evil spectre, the size of it is unreal...[otherwise if the item described is ghostly tentacle]This transparent purple tentacle is hanging from the ceiling, drooling some brightly coloured green fluid.[otherwise][one of]This transparent, faintly glowing green penis is floating a few feet off the ground. It certainly doesn't move as if it's attached to some invisible main body, but sometimes when you look at it from just the right angle, you feel like there's an outline of someone standing behind it.[or]Obviously some kind of ghost, this glowing male sex organ is slightly transparent and floats a few feet off the ground. It seems to have something of a mind of its own.[or]A sickly green penis, floating aimlessly a few feet off the ground. Its [']body['] is slightly transparent, and it casts a dim glow over the surrounding walls and furniture. It's obvious it wants to fuck you.[at random][end if]";
		say "[variable custom style][if the player is male and the bimbo of the player < 5][one of]I guess if I only had one part I could show as a ghost...[or]That's not spooky, just weird. Really weird.[or]Doesn't look solid. Wouldn't take that deal even if it made me that big.[in random order][otherwise if the bimbo of the player < 5][one of]Wow, that's so creepy.[or]At least if it tries to fuck me I'll know it won't make gross faces at me the whole time.[or]I know I'm going to have to fight that thing off eventually. But it doesn't look solid...[in random order][otherwise if the bimbo of the player < 8 and the player is male][one of]So is that a dick's ghost or a ghost's dick?[or]It reminds me of my dick in a way. But weirder. And higher up.[at random][otherwise if the bimbo of the player < 8][one of]Why does everything have to be sexual in this game...[or]Something perverted like that probably wouldn't handle blessings very well.[or]I guess this is the kind of unholy creature you would expect from this game.[at random][otherwise if the bimbo of the player < 12 and the player is male and the size of penis < 6][one of]It's bigger than mine...[or]It's huge! Wait... no. I'm just small.[or]I wish mine was that big....[in random order][otherwise if the bimbo of the player < 12][one of]It's gross, but not in a way that turns me off.[or]If I let it fuck me...how would it feel? Would I feel anything?[or]It wouldn't bother me nearly as much if it had a pair of balls.[in random order][otherwise][one of]I want to know how it would feel inside of me[or]I wonder what its [semen] tastes like...[or]Big. Just how I like it.[or]I can see through it. That means when I suck it I can see the load before it even touches my tongue![or]It doesn't look like I can touch it normally. But I'm sure it can fuck me, that's what dicks are for![in random order][end if][roman type][line break]";
	otherwise:
		if images visible is 1:
			if item described is jismbodied ghost, display figure of ghost 3;
			otherwise display figure of ghost 1;
		say "[if the item described is jismbodied ghost]A floating ball of translucent slime, which casts a dim glow over the surrounding walls and floor. Although it clearly isn't solid, looking at its choppy, constantly roiling surface makes you really afraid to touch it.[otherwise if the item described is ghostly tentacle]This transparent purple tentacle is creeping slowly along the ceiling, coiled up as if ready for an ambush.[otherwise]A floating ball of pallid green flames, which casts an eerie glow over the surrounding walls and floor. If you look at it from the right angle, sometimes you can see a distinctly phallic silhouette hanging underneath it.[end if]";
		say "[variable custom style][if the item described is jismbodied ghost]It looks like a ball of floating [semen]...[otherwise]I have a feeling there's more to it than that.[end if][roman type]".

Definition: a ghost (called M) is blocker:
	decide no.		

To set up (M - a ghost):
	reset M;
	now the monstersetup of M is 1;
	if M is jismbodied ghost, now the difficulty of M is 8;
	otherwise now the difficulty of M is 6;
	now the health of M is the maxhealth of M;
	now M is phased.

To decide which number is the maxhealth of (M - a ghost):
	decide on 1 + (the difficulty of M * game difficulty).

To decide which number is the maxhealth of (M - a jismbodied ghost):
	decide on 1 + (the difficulty of M * (2 + game difficulty)).

To decide which number is the girth of (M - a jismbodied ghost):
	if the location of the player is garlic, decide on 5;[weakened, but not beaten]
	decide on 7.

To decide which number is the girth of (M - a ghost):
	[decide on the size of a random sex toy retained by M;]
	decide on 3.

This is the spawn initial ghosts rule:
	if diaper quest is 1:
		repeat with M running through ghosts:
			now M is not mansion dwelling;[Consider replacing ghosts with floating pacifiers, maybe?]
	otherwise if the number of alive ghosts is 0:
		let M be a random off-stage jismbodied ghost;
		set up M;
		summon M in the mansion.
The spawn initial ghosts rule is listed in the setting up mansion monsters rules.

To compute sleeping of (M - a ghost):
	compute scared reduction of M;
	compute questioned reduction of M;
	compute boredom reduction of M;
	compute sleep reduction of M;
	if the bank of M < 120:
		increase the bank of M by seconds.[So, around 20 turns to recharge]

To satisfy (M - a jismbodied ghost) for (N - a number) seconds:
	if M is interested:
		bore M for N seconds;
		if M is in the location of the player, say "[SatisfiedFlav of M]";
	otherwise:
		bore M for N seconds.[We still want to dislodge etc. even if they weren't interested for some reason.]

To satisfy (M - a ghost) for (N - a number) seconds:
	say "The [M] slowly fades out of existence. You have a feeling you'll be seeing it again...";
	destroy M;
	bore M for N seconds.[Is dislodging handled with the destroy M function?.]

To compute unique early action of (M - a ghost):
	if the wind-up of M is 1:
		compute ectoplasm to M;[Ghosts explode when they wind up, no matter what.]

To compute unique final action of (M - a ghost):
	compute phaseout of M;

To compute phaseout of (M - a ghost):
	if the location of M is garlic and M is phased:
		now M is unphased;
		if M is in the location of the player, say "The [M] bristles as it enters the room, flickering as it shifts fully into the corporeal world.";
	otherwise if M is unphased and the location of M is not garlic:
		now M is phased;
		if M is in the location of the player, say "The [M] shimmers as it shifts out of the corporeal world.".

To compute unique final action of (M - a ghostly tentacle):
	do nothing.

To say SummoningFlav of (M - a ghost):
	if M is in the location of the player, say "You hear far away laughter as the glow surrounding the mummy intensifies and simultaneously converges [if trap fetish is 0]on her crotch, [otherwise]in front of her face, [end if] coalescing into a [printed name of M] and immediatley [if bukkake fetish is 1 and trap fetish is 1]ejaculates all over her face[otherwise if trap fetish is 1]phases through her face, causing a very audible gagging noise as it comes out the other side[otherwise]ejaculates[end if].  The mummy slowly climbs to its feet, spit and [semen] absorbing into the frayed cloth without another trace.";
	otherwise say "You hear distant laughter somewhere else in the mansion.".

To say he of (M - a ghost):
	say "it".

To say big he of (M - a ghost):
	say "It".

To say him of (M - a ghost):
	say "it".

To say his of (M - a ghost):
	say "its".

To say big his of (M - a ghost):
	say "its".

To say himself of (M - a ghost):
	say "itself".

To compute labour to (M - a ghost):
	compute pregnancy clothing displacement;
	say "[PregFlav]Slime trickles out of your [vagina], collecting in a pool between your legs as a steady flow of viscous, glowing fluid spreads across the floor beneath you. A heavy, suffocating feeling falls over your surroundings as your belly slowly returns to its original size, and even as some of the slime begins to disappear, its glow seems to intensify. Tiny pinpricks of light rise up from the wet floor, growing and intensifying into a floating horde of big, green, and very erect penises right before your eyes.";
	repeat with N running through ghosts:
		unless N is ghostly tentacle:
			set up N;
			now N is anal;
			now N is not penetrating asshole;
			now N is not penetrating vagina;
			now N is in the location of the player;
	compute fatherhood to M;
	increase the stickiness of the player by 3.

To compute fatherhood to (M - a ghost):
	[now the father is not interested;]
	now the father is not penetrating asshole;
	now the father is not penetrating vagina;
	now the father is not grabbing the player.

Part 1 - Perception

Definition: a ghost (called M) is objectifying the player:
	if (the bimbo of the player >= 20 or the appearance of the player >= 20), decide yes;
	if the player is immobile, decide yes;
	if the player is prone, decide yes;
	if [the player is in the mansion and ]the slime-puddle of the location of the player > 0, decide yes;
	[if the class of the player is faerie, decide no;]
	if the appearance of the player > the bimbo tolerance of M, decide yes;
	decide no.[The ghost won't go for you unless you're vulnerable or slutty]

To compute perception of (M - a ghost):
	now M is interested;
	let A be 0;
	repeat with N running through monsters in the location of the player:
		if the favour of N >= the aggro limit of N, now A is 1;
	if M is unfriendly or the bimbo of the player >= 15 or A is 1:
		say "[if M is jismbodied ghost]The [M] seems to reform itself, elongating slowly until a foot-long, slimy [manly-penis] thick enough to qualify as lumber is hovering in the air in front of you. [otherwise]Light seems to converge in front of the [M], and forming a massive, and very erect [manly-penis] right before your eyes. [end if]From the way it's pointing at you it's not hard to guess at its intentions....";
		anger M;
	otherwise:
		say "The light cast by the [M] seems to change, and it begins to follow you around".


Part 2 - Combat

Section 1 - Protection

To compute (M - a ghost) protecting against (X - a monster):
	unless M is unfriendly:
		say "[if M is jismbodied ghost]The [M] seems to reform itself, elongating slowly until a foot-long, slimy [manly-penis] thick enough to qualify as lumber is hovering in the air in front of you.[otherwise]Light seems to converge in front of the [M], and forming a massive, and very erect [manly-penis] right before your eyes.[end if] From the way it's pointing at you it's not hard to guess at its intentions....";
		anger M.

Section 2 - Sex

The ghost insertion rules is a rulebook. The insertion rules of a ghost is usually the ghost insertion rules.

This is the ghost hole insertion rule:
	if chosen-orifice of current-monster is asshole, follow the ghost asshole insertion rules;
	if chosen-orifice of current-monster is vagina, follow the ghost vagina insertion rules;
	if chosen-orifice of current-monster is face, follow the ghost mouth insertion rules;
	if chosen-orifice of current-monster is breasts, compute current-monster entering breasts.[shouldn't happen]
The ghost hole insertion rule is listed in the ghost insertion rules.

The ghost asshole insertion rules is a rulebook. 

This is the blessings block ghosts rule:[ghosts normally phase through orifice blocking objects, but not when blessings are involved.]
	if chosen-orifice of current-monster is asshole, let C be a random worn blessed total protection clothing;
	otherwise let C be a random worn blessed pussy protection clothing;
	if C is clothing:
		compute current-monster attacking C;
		rule succeeds;
	otherwise:
		let P be a random insertable thing penetrating chosen-orifice of current-monster;
		if P is an insertable thing:
			compute current-monster removing P;
			rule succeeds.
The blessings block ghosts rule is listed last in the ghost asshole insertion rules. The monster penetrating asshole rule is listed last in the ghost asshole insertion rules.

To compute (M - a ghost) entering asshole:
	now the sex-length of M is 3;
	say "[AssholePenetrationFlav of M]";
	now M is penetrating asshole;
	AssRuin 1.

To say AssholePenetrationFlav of (M - a ghost):
	let C be a random worn total protection clothing;
	if C is clothing and M is jismbodied ghost and bukkake fetish is 1, CumSoak 5 on C;
	let P be a random sex toy penetrating asshole;
	say "The [M] floats behind you, [one of]surprising you[or]once again surprising you[stopping] [if C is clothing] as a very tangible cockhead pokes your [asshole] through your [printed name of C].[otherwise if P is worn]with a very tangible shaft rubbing itself between your asscheeks.[otherwise]with a very tangible tip prodding at your [asshole].[end if][if C is clothing] [one of]Instead of being blocked or delayed by the layer of [clothing-material of C] protecting your hole, it simply passes through![or]It simply passes through the layer of [clothing-material of C] covering your hole.[at random][end if] You [if the openness of asshole < 3]grunt[otherwise if the anal sex addiction of the player < 4]gasp[otherwise]sigh[end if] as it slowly slides its way in[if P is worn], ignoring your [printed name of P] completely as it[otherwise] and[end if] begins to thrust.".

To compute anal sex of (M - a ghost):
	compute fuckhole sex of M.

To compute fuckhole sex of (M - a ghost):
	say "[one of][M submission sex 1][or][M submission sex 2][or][M submission sex 3][or][M submission sex 4][or][M submission sex 5][or][M submission sex 6][or][M submission sex 7][at random]";
	if M is penetrating vagina, PussyRuin 1;
	otherwise AssRuin 1;
	decrease the sex-length of M by 1;
	say "[one of][M sex reaction][or][cycling]".

To say (M - a ghost) submission sex (N - a number):
	let O be a random orifice penetrated by M;
	if N is 1:
		if the reaction of the player is 0:
			say "[if the relevant sex addiction of M > 12]The [M] pistons in and out of your [variable O], panting heavily. You're enjoying it so much you can hardly think![otherwise if the relevant sex addiction of M > 7]The [M] fucks your [variable O] with fast, hard thrusts. You close your eyes and tilt your head to the ground, trying to ignore how good it feels.[otherwise]The [M] plunges in and out of your [variable O] with wild abandon! It's so intense you can hardly think![end if]";
		if the reaction of the player > 0:
			say "[if the relevant sex addiction of M < 6]The [M] slams in and out of your [variable O]. It's extra humiliating because you're letting it happen![otherwise if the relevant sex addiction of M < 10]The [M] slams in and out of your [variable O], panting heavily. You try to convince yourself you're not letting it happen because you enjoy it.[otherwise]The [M] fucks your [variable O] with fast, hard thrusts. You close your eyes and tilt your head to the ground, losing yourself to pleasure.[end if]";
	if N is 2:
		if the reaction of the player is 0:
			say "[if there is a worn ballgag and the bimbo of the player > 12]The [M] slams in and out of your [variable O]. You feel slightly annoyed that your [random worn ballgag] is muffling your moans.[otherwise if there is a worn ballgag and the bimbo of the player > 7]The [M] slams in and out of your [variable O]. You[']re glad it isn[']t attached to any real man with how terribly your [random worn ballgag] muffles the sound of your moans.[otherwise if there is a worn ballgag]The [M] relentlessly pounds your [variable O]. Your grunts of displeasure are conveniently muffled by the [random worn ballgag] in your mouth.[otherwise if the relevant sex addiction of M > 12]The [M] gives your [variable O] the hard fucking it deserves. You arch your back and shamelessly moan in pleasure.[otherwise if the relevant sex addiction of M > 7]The [M] gives your [variable O] the hard fucking it deserves. You arch your back and emit an involuntary moan of pleasure.[otherwise]The [M] gives your [variable O] the hard fucking it deserves. You dig your fingernails into the floorboards, growling with displeasure.[end if]";
		otherwise:
			say "[if the relevant sex addiction of M < 7]The [M] gives your [variable O] the hard fucking it deserves. You clench your fists and try to ignore your growing fear and embarrassment.[otherwise if the humiliation of the player < 15000]The [M] fucks your [variable O] with, rough, brutal thrusts. You can almost feel your dignity crumbling, every thrust humiliating you more and more.[otherwise if the relevant sex addiction of M < 10]The [M] plows in and out of your [variable O]. There's something so invigorating about letting it happen![otherwise]The [M] plows in and out of your [variable O]. It's so satisfying to let it happen![end if]";
	if N is 3:
		say "A pair of ghostly hands materialise underneath you, [one of]eagerly fondling your [BreastDesc][or]cruelly twisting your nipples[or]tweaking your nipples and palming your [BreastDesc][or][if the largeness of breasts < 4]shamelessly manhandling your [BreastDesc][otherwise]cruelly slapping your [BreastDesc][end if][or]playing with your [BreastDesc][at random] as the [M] [one of]pistons[or]slams[or]thrusts[at random] in and out of your [variable O].";
	if N is 4:
		let F be a random monster penetrating face;
		say "You [one of]suddenly feel a hand on your back, pushing you into the [if F is monster][F][otherwise]floor[end if][or]hear someone grunting heavily behind you[at random] as the [M] [one of]pistons[or]slams[at random] in and out of your [variable O].";
	if N is 3:
		let C be a random worn skirted clothing;
		if C is nothing, let C be a random worn crotch covering clothing;
		say "You feel a hand [if C is clothing]slip underneath your [printed name of C] and fondle your [AssDesc][otherwise]smack your [AssDesc][end if] as the [M] plows your [variable O], followed shortly by several more, which take turns fondling your body from impossible angles.";
	if N is 6:
		if the player is male, say "[if the size of penis < 4 and tg fetish >= 1]The [M] ruts you like an animal. Even disembodied dicks are more manly than you![otherwise if the size of penis < 4 and the size of penis > 0 and the bimbo of the player < 14]The [M] pounds your [asshole] hard and fast. You can't help feeling a little embarrassed by how minuscule your [ShortDesc of penis] is, considering it's actually attached to someone.[otherwise if the size of penis < 4 and the size of penis > 0]The [M] pounds your [asshole] hard and fast. You can't help feeling proud of how minuscule your [sissy-penis] is by comparison.[otherwise if the bimbo of the player < 3]Your [ShortBallsDesc] jiggle as the [M] pistons in and out of your [asshole], as if to remind you how powerless you are against a real dick in action.[otherwise if the bimbo of the player < 5]Shocks of pleasure ripple through your [ShortDesc of penis] as [he of M] pounds your [asshole]. And you thought it was humiliating before...[otherwise if the bimbo of the player < 7]The [M] relentlessly pounds your sensitive prostate, reminding you how humiliating it is to have a [manly-penis] slamming in and out of your ass.[otherwise if the bimbo of the player < 9]Shocks of pleasure ripple through your [ShortDesc of penis] as the [M] relentlessly pounds your [asshole]. It's difficult to resist when it feels this good.[otherwise if the bimbo of the player < 10]The [M] relentlessly pounds your sensitive prostate, continuing to remind you who the 'man' is between the two of you.[otherwise if the bimbo of the player < 12]Your [ShortBallsDesc] jiggle as the [M] pistons in and out of your [asshole]. You find yourself biting your lower lip, secretly savouring the feeling of helplessness.[otherwise if the bimbo of the player < 14]Your [ShortBallsDesc] jiggle as the [M] pistons in and out of your [asshole], as if to remind you how much you LOVE getting fucked.[otherwise]Shocks of pleasure ripple through your [ShortDesc of penis] as the [M] pounds your [asshole]. Phew, it sure knows how to show a girl a good time![end if]";
		otherwise say "[if the relevant sex addiction of M < 8]The [M] fucks your [variable O] with all the callousness and vigour of an actual man![otherwise if relevant sex addiction of M < 13]The [M] fucks your [variable O] hard and fast! You pretend you only like it because it's not attached to any man you can see.[otherwise]The [M] fucks your [variable O] with all the roughness and power of an actual man! You're half disappointed you don't have one to thank for all this hard fucking.[end if]";
	if N is 7:
		let F be the openness of O - the girth of M;
		say "[if the F < 0 and the relevant sex addiction of M > 11]The [M] is roughly fucking your [variable O] at breakneck speed. It's even better because it barely fits![otherwise if F < -2]The thickness of the [M]'s [manly-penis] is VERY noticeable as [he of M] slams it in and out of your tight [variable O].[otherwise if F < 0]The [M] ruts you like an animal. Each of [his of M] thrusts reach nice and deep, as if to acclimate your tight [variable O] to the feeling of [manly-penis].[otherwise if F > 4]The [M] pounds your [variable O] mercilessly, but your [variable O] is so stretched that it doesn't feel rough at all.[otherwise if F > 2]The [M] fucks you hard and fast. However, your [variable O] is loose enough that it doesn[']t actually feel rough at all.[otherwise]The [M]'s thrusts come quickly, greedily seeking the inner reaches of your [variable O].[end if]".

The ghost vagina insertion rules is a rulebook. The blessings block ghosts rule is listed last in the ghost vagina insertion rules. The monster penetrating vagina rule is listed last in the ghost vagina insertion rules.

To compute (M - a ghost) entering vagina:
	now the sex-length of M is 3;
	say "[VaginaPenetrationFlav of M]";
	now M is penetrating vagina;
	PussyRuin 1.

To say VaginaPenetrationFlav of (M - a ghost):
	let C be a random worn total protection clothing;
	if C is clothing and M is jismbodied ghost and bukkake fetish is 1, CumSoak 5 on C;
	let P be a random sex toy penetrating vagina;
	say "The [M] floats behind you, [one of]surprising you[or]once again surprising you[stopping] [if C is clothing] as a very tangible cockhead brushes your clit through your [printed name of C].[otherwise if P is worn]with a very tangible shaft rubbing itself on your inner thighs.[otherwise]with a very tangible tip rubbing your [vagina].[end if][if C is clothing] [one of]Instead of being blocked or delayed by the layer of [clothing-material of C] protecting your hole, it simply passes through![or]It simply passes through the layer of [clothing-material of C] covering your hole.[at random][end if] You [if the openness of asshole < 3]grunt[otherwise if the relevant sex addiction of M < 8]gasp[otherwise]sigh[end if] as it slowly slides its way in[if P is worn], ignoring your [printed name of P] completely as it[otherwise] and[end if] begins to thrust.".

To compute vaginal sex of (M - a ghost):
	compute fuckhole sex of M.

The ghost mouth insertion rules is a rulebook.

This is the ghosts possess gags rule:
	let C be a random worn clothing penetrating face;
	if C is clothing:
		compute current-monster removing C;
		rule succeeds.[only one clothing can penetrate face at a time, so we know nothing is blessed if C is not blessed.]
The ghosts possess gags rule is listed last in the ghost mouth insertion rules. The monster penetrating mouth rule is listed last in the ghost mouth insertion rules.

To compute (M - a ghost) entering mouth:
	now the sex-length of M is 3;
	say "[one of]The [M] moves in closer to your face[or]The [M] floats closer to your face[or]The [M] floats up to your face[at random], throbbing visibly as[one of] a surprisingly[or][stopping] tangible cockhead [if presented-orifice is face][one of]pushes itself into your open mouth[or]slides into your open mouth[or]brushes your lips as it slides into your mouth[or]nudges your tongue as it enters your mouth[at random].[otherwise][one of]prods your pursed lips, which suddenly pop open at its chilling touch.[or]stings your lips with unnatural cold, which forces your lips to obediently fall open.[or]brushes your pursed lips, which sting with unnatural cold as they suddenly pop open.[or]phases through your lips, filling them with unnatural cold as they suddenly open.[at random][end if][if presented-orifice is face][one of]You look down as it slowly begins to thrust[or]It rests in your mouth for a moment before beginning to thrust[or]It feels even more real when it begins to thrust[at random][otherwise if the oral sex addiction of the player < 4]Your scream is abruptly cut off as it slides in and begins to thrust[otherwise if the oral sex addiction of the player < 7]You look down helplessly as it slides in and begins to thrust[otherwise]You look down happily as it slides in and begins to thrust[end if].";
	now M is penetrating face.


To say OralResisting of (M - a ghost):
	say "[one of]Nothing you do comes anywhere close to forcing the invader out of your mouth.[or]You do everything you can to pull away from your floating assailant.[or]No matter how much you struggle, you can't get it away.[or]You struggle, but there's no escaping it![at random]".

To say OralResistingResponse of (M - a ghost):
	say "[one of]The [M] doesn't seem bothered by your struggling and continues thrusting at full force![or]The [M] continues thrusting undeterred, gagging you repeatedly as it slams into the back of your throat.[or]The [M] ignores your struggling completely, continuing to thrust its little heart out.[or]The [M] thrusts relentlessly, ensuring you don't go a moment without tasting every inch of its ghostly shaft.[or]The [M] continues to facefuck you without stopping.[or]The [M] continues thrusting despite your protests![in random order]".

To say OralSubmissionResponse of (M - a ghost):
	let D be the delicateness of the player + the oral sex addiction of the player;
	say "[one of]You stay still as the [M] thrusts in and out of your mouth [if D < 8]terrified to resist[otherwise]shivering with excitement[end if][or]You [if D < 9]fearfully[otherwise if D < 12]hesitantly[otherwise]eagerly[end if] bob your head back and forth, obediently polishing the disembodied cock in your mouth.[or]You make quiet slurping noises as the [M] fucks your mouth, [if D < 7]fearful of what it might do if you try to resist.[otherwise if the oral sex addiction of the player < 5]disgusted at what you're allowing it to do.[otherwise]obediently stroking the underside with your tongue.[end if][or]The [M] eagerly thrusts in and out of your mouth, more than tangible enough to gag you every time it rams into the back of your throat.[or]The [M] thrusts vigorously, taking full advantage of your submissive attitude to repeatedly slam into the back of your throat.[at random]";

To say NearingClimaxOral of (M - a ghost):
	say "[one of]The [M] seems to be speeding up![or]The [M] thrusts faster and faster with no regard for your reaction.[or]The space between the [M]'s thrusts gets smaller with every passing moment![in random order] It must be close!".

To compute (M - a ghost) attacking (C - a clothing):
	if C is blessed and M is jismbodied ghost:
		say "The [M] smacks your [printed name of C], leaving a heavy layer of [semen] behind. It seems to lose interest.";
		distract M;
	otherwise if C is blessed:
		say "The [M] floats behind you, prodding your [chosen-orifice of M] through your [printed name of C]. It recoils immediately and loses interest.";
		distract M;
	otherwise:
		say "The [M] awkwardly rubs itself on your [printed name of C] before backing off. It doesn[']t know how to deal with it, please report this bug!".

To compute (M - a ghost) removing (C - a throbbing-tentacle):
	say "The [M] floats behind you, prodding your [printed name of C]. It seems to wait for a few moments before losing interest.";
	distract M.

To compute (M - a ghost) removing (C - a sex toy):
	say "The [M] floats behind you, prodding your [printed name of C]. [one of]Undeterred, it phases into your [chosen-orifice of M], causing the toy to wiggle and throb with new-found life.[or]Once again, the [M] phases into your [chosen-orifice of M], causing the toy to bulge and throb with unnatural life.[stopping] [if the relevant sex addiction of M < 8]You whimper as it slowly begins to fuck you.[otherwise if the relevant sex addiction of M < 12]Shivers run up your spine as it slowly begins to fuck you.[otherwise]A shiver of anticipation runs up your spine as it begins to fuck you.[end if]";
	now C is in the holding pen;
	now M is retaining C;
	dislodge C;
	now M is penetrating chosen-orifice of M.

To compute (M - a ghost) removing (C - a golden phallus):
	if C is blessed:
		say "The [M] floats behind you, but seems to back off when it gets near your [printed name of C]. It loses interest.";
		distract M;[normally it would ignore the blessing since this item is cock shaped, but gold has magical properties]
	otherwise:
		say "The [M] floats behind you, prodding your [printed name of C]. [one of]Undeterred, it phases into your [chosen-orifice of M], causing the toy to wiggle and throb with new-found life.[or]Once again, the [M] phases into your [chosen-orifice of M], causing the toy to bulge and throb with unnatural life.[stopping] [if the relevant sex addiction of M < 8]You whimper as it slowly begins to fuck you.[otherwise if the relevant sex addiction of M < 12]Shivers run up your spine as it slowly begins to fuck you.[otherwise]A shiver of anticipation runs up your spine as it begins to fuck you.[end if]";
		now C is in the holding pen;
		now M is retaining C;
		dislodge C;
		now M is penetrating chosen-orifice of M.

To compute (M - a ghost) removing (B - a ballgag):
	if B is blessed and B is not cock pacifier:
		say "The [M] floats closer to your face, but seems to recoil when it gets near your [printed name of B]. It loses interest.";
		distract M;
	otherwise if B is pacifier:
		say "The [M] floats closer to your face, throbbing visibly as it nears your [printed name of B]. Your eyes widen as its ephemeral [']body['] disappears into the plastic, causing the [if B is cock pacifier]phallic nub[otherwise]chewable nub[end if] to wiggle and pulse before shooting several strings of warm [semen] directly into your mouth.";
		StomachSemenUp the semen load of M;
		now B is cursed;
		satisfy M;
	otherwise:
		say "The [M] floats closer to your face, throbbing visibly as it nears your mouth. Your [printed name of B] shimmers briefly before it slowly disappears, leaving behind only a faint outline of its shape. Somehow, your mouth remains wide open, and you [if the oral sex addiction of the player < 4][one of]shudder as the [M] slowly pushes in[or]screw your eyes shut as the [M] slowly slides in[or]shiver as the [M] slides in completely unimpeded[at random][otherwise][one of]lean forward as the [M] slowly slides in[or]obediently wait as the [M] slides in completely unimpeded[at random][end if] and begins to thrust.";
		now B is in the holding pen;
		now M is retaining B;
		dislodge B;
		now M is penetrating chosen-orifice of M.


Section 3 - Continue and Finish Sex

Definition: a ghost (called M) is able to remove cursed plugs: [Can the monster remove all plugs & ballgags?]
	decide yes.

The ghost end of sex rules is a rulebook. The end of sex rules of a ghost is usually the ghost end of sex rules.

The reset chosen orifice rule is listed first in the ghost end of sex rules. 

To finish possession of (T - a thing) in (O - an orifice):
	unless O is actually occupied or current-monster is not intelligent:
		say "The [T] reappears in your [variable O].";
		now T is worn by the player;
		now T is penetrating O;
		now current-monster is not retaining T.

This is the ghost facial climax rule:
	if current-monster is penetrating face, compute facial climax of current-monster;
	repeat with G running through ballgags retained by current-monster:
		finish possession of G in face.
The ghost facial climax rule is listed in the ghost end of sex rules. 

To compute facial climax of (M - a ghost):
	let R be 0;
	if bukkake fetish is 1 and the player is not a blowjob slut and a random number between 1 and 2 is 1:[ghosts have homing jizz]
		say FailedFacialDodge of M;
		CumFaceUp the semen load of M;
		unless the reaction of the player is 0, humiliate 200;
	otherwise: [Internal cumshot]
		if the reaction of the player is 0:
			say ResistedOralCreampie of M;[the cumshot rests in your mouth for a second before going down on its own.]
			StomachSemenUp the semen load of M;
		otherwise: [submitted, deepthroat]
			say DeepthroatCreampie of M;
			StomachSemenUp the semen load of M;
			humiliate 100;
	TimesFuckedUp M by 1;
	satisfy M.

To say FailedFacialDodge of (M - a ghost):
	say "[one of]Ghostly hands materialise to hold you still as the [M] ejaculates all over your face.[or]Your face is covered in a thick load of [semen] before you can even think about turning your face away.[or]The [M] pops out of your mouth and immediately goes over the edge. You take a full ejaculation all over your face.[or]The [M] pops out of your mouth as it goes over the edge, flexing as it shoots several long ropes of [semen] at you in rapid succession. [if the reaction of the player is 0]You react fast enough to duck out of the way, but the individual strands somehow curve in mid-air, and you still take a full splattering to the face.[otherwise]You close your eyes, obediently taking the full load all over your face.[end if][or]The [M] pulls out and immediately begins to unload all over your face. [if the reaction of the player is 0]You react fast enough to dodge most of it, but just when you think you're safe, it somehow loops around your head and hits you from the other side[otherwise]You barely have time to shut your eyes as the [semen] hits your face[end if][or][if the semen addiction of the player < 8]Knowing what's coming, as soon as the [M] pulls out, you try to get out of the way. Unfortunately, you just aren[']t fast enough, and you get a full facial anyway.[otherwise if the semen addiction of the player < 12]You know what's coming when the [M] pulls out, but you can[']t find the will to struggle and sit obediently for a hot, sticky facial.[otherwise]You immediately know what[']s coming when the [M] pulls out, and happily close your eyes for a hot, sticky facial.[end if][or]The [M] pops out of your mouth and immediately jizzes all over your face[or]The [M] withdraws from your mouth and immediately gives you a warm, messy facial.[in random order]".

To say ResistedOralCreampie of (M - a ghost):
	say "[one of]The [M] explodes into your mouth, filling it with the [semen-adjective] taste of [semen]. It rests there for a few seconds before slowly sliding down your throat.[or]A pair of ghostly hands materialise on either side of the [M] and hold you down as it ejaculates into your mouth. [if the semen taste addiction of the player > 14]No matter how much you want to swallow it, it stays there for a few moments, ensuring you get a deep, thorough taste before sliding down your throat.[otherwise if the semen taste addiction of the  player > 9]It rests there for a few moments, as if spreading its taste around in your mouth before it slides down your throat.[otherwise]No matter how much you want to spit it out, it clings to the bottom of your mouth, forcing you to endure its taste until it's ready to slide down your throat.[end if][or]The [M] tenses, shooting several ropes of thick, warm [semen] directly into your mouth. It seems to have a mind of its own, settling in the bottom of your mouth before slowly creeping down your throat.[or]Ghostly hands appear to hold you down as [semen] spurts into your mouth, which somehow manages to swish it [semen-adjective] taste around in your mouth before jumping down your throat.[or]The [M] shoots long ropes of [semen] into your mouth, which hit your tongue with pinpoint accuracy. [if the semen taste addiction of the player < 8]You crinkle your nose at the [semen-adjective] taste and swallow the strangely lively fluid[otherwise if the semen taste addiction of the player < 13]You pause for a moment to mull over the [semen-adjective] taste before swallowing the weirdly lively fluid.[otherwise]You eagerly swish it around in your mouth, spreading the [semen-adjective] taste around as much as you can before swallowing.[end if][in random order]".

To say DeepthroatCreampie of (M - a ghost):
	say "[one of][or]The [M] throbs powerfully, firing off load after load of warm [semen] straight down your throat.[or]The [M] shoots long ropes of [semen] directly into your mouth, which arc down your throat with perfect accuracy.[or]The [M] pushes itself fully into your mouth, throbbing subtly as it paints the back of your throat with wave after wave of hot, stick [semen].[or]A pair of ghostly hands appear to hold you down as the [M] ejaculates, forcibly tilting your head so every last drop of [semen] sails down your throat.[or][if the semen taste addiction of the player < 8]You do your best to keep your tongue flat as the [M] shoots down your throat, making sure you don[']t have to taste any [semen] on its way down.[otherwise if the semen taste addiction of the player < 12]You gently stroke the underside of the [M] as [semen] spurts down your throat, knowing it's better if you avoid tasting it at all[otherwise]You skilfully rub the underside of the [M] with your tongue as [semen] shoots down your throat, determined to coax out the biggest load you can.[end if][in random order]".

This is the ghost anal climax rule:
	if current-monster is penetrating asshole, compute anal climax of current-monster;
	repeat with G running through sex toys retained by current-monster:
		finish possession of G in asshole.
The ghost anal climax rule is listed in the ghost end of sex rules.

To compute anal climax of (M - a ghost):
	compute fuckhole climax of M.

To finish possession of (T - a sex toy) in (O - an orifice):
	unless O is actually occupied or current-monster is not intelligent:
		say "The [current-monster] leaves the [T] behind in your [variable O], plugging all the [semen] inside of you.";
		now T is worn by the player;
		now T is cursed;
		now T is penetrating O;
		now current-monster is not retaining T.

This is the ghost vaginal climax rule:
	if current-monster is penetrating vagina, compute vaginal climax of current-monster;
	repeat with G running through sex toys retained by current-monster:
		finish possession of G in vagina.
The ghost vaginal climax rule is listed in the ghost end of sex rules.

To compute vaginal climax of (M - a ghost):
	compute fuckhole climax of M.

To compute fuckhole climax of (M - a ghost):
	TimesFuckedUp M by 1;
	let F be a random fuckhole penetrated by M;
	say "[one of]The room fills with a ghastly glow as the [M] slams itself home, eagerly flooding your [variable F] with its seed. After several [if the semen addiction of the player < 7]excruciating[otherwise if the semen addiction of the player < 15]intense[otherwise]wonderful[end if] moments of stillness, broken only by the subtle twitching between loads, the [M] pulls out and leaves you to [if the semen addiction of the player < 10]crawl away in shame[otherwise]take in what just happened[end if].[or]The [M] jizzes directly into your [variable F], continuing to thrust until your deepest, most intimate recesses have been acquainted with its ghastly [semen]. You look over your shoulder, [if the semen addiction of the player < 7]shuddering[otherwise]quivering[end if][if the semen addiction of the player > 14] with excitement[end if] as it pulls out and floats away.[or]The [M] throbs as it pumps load after load of thick [semen] directly into your [variable F], pushing it nice and deep with a few last thrusts before pulling out and leaving you alone.[or]The [M] continues to thrust as its [semen] flows inside of you, as if to ensure you won[']t forget the sensation until long after it pulls out and leaves you alone[if semen addiction of the player < 7], no matter how much you want to[otherwise if the semen addiction of the player < 11], although you aren't sure how you could[otherwise], which is exactly the way you like it[end if].[at random][line break]";
	if M is penetrating vagina:
		wombfill the semen load of M;
		now M is not penetrating vagina;
	if M is penetrating asshole:
		assfill the semen load of M;
		now M is not penetrating asshole;
	satisfy M.
	
Section 4 - Attack

To compute ectoplasm to (M - a ghost):
	if bukkake fetish is 1, now the slime-puddle of the location of M is a random number between 5 and 10;
	otherwise now the slime-puddle of the location of M is 3;
	if M is jismbodied ghost, increase the slime-puddle of the location of M by 10;
	decrease the bank of M by 100;
	if M is in the location of the player and the player is upright:
		say "[if bukkake fetish is 1]The [M] ejaculates violently, knocking you to your knees with a torrent of bright green, glowing slime.[otherwise]The [M] releases a violent pulse of energy, knocking you to your knees[end if].";
		try kneeling;[How many seconds the player is trapped before they can move]
	otherwise if M is in the location of the player:
		say "[if bukkake fetish is 1]The [M] ejaculates violently, dousing you in a thick layer of bright green, glowing slime.[otherwise]The [M] releases a violent pulse of energy, causing everything in the vicinity to vibrate with powerful magic.[end if]";
		say "[if bukkake fetish is 1]The thick slime on the floor instantly adheres to your skin![otherwise]The glowing surface of the floor seems to glue itself to your skin![end if][line break]";
		increase the stickiness of the player by 7;
	otherwise:
		say "[if bukkake fetish is 1]You hear a sound similar to a fire hydrant being smashed open somewhere else in the mansion[otherwise]You hear a loud crash somewhere else in the mansion[end if][line break]";
	now the wind-up of M is 0.

The ghost priority attack rules is a rulebook.  The priority attack rules of a ghost is usually the ghost priority attack rules.

[This is the ghosts are patient rule:
	if current-monster is objectifying the player and current-monster is not unfriendly:
		say "The [current-monster] visibly stiffens. Uh oh.";
		anger current-monster;
		rule succeeds.
The ghosts are patient rule is listed in the ghost priority attack rules.]

This is the ghost winding rule:[Ghosts should wind up if they have a full bank and haven't been given an "invitation" to fuck you]
	if debugmode > 0, say "Checking ghost winding rule....[line break]";
	if the player is not immobile and presented-orifice is nothing and the bank of current-monster > 100:
		let W be 0;
		repeat with M running through ghosts in the location of the player:
			if the wind-up of M is 1, now W is 1;
		if W is 0:[Not a huge deal if the ghosts have a huge, super jizzy party, but it makes more sense that they do it in succession. No winding if a nearby ghost has already wound up. Otherwise, fair game.]
			say "[if bukkake fetish is 1]The [current-monster] begins to glow brighter and brighter green, a thin strand of slimy 'drool' leaking out of the tip as its veins bulge with sudden definition.[otherwise]The [current-monster] begins to glow brighter and brighter green, your surroundings creaking and shaking as the pale light fills the room.[end if]";
			now the wind-up of current-monster is 1;[TODO: one of's]
			repeat with N running through intelligent monsters in the location of current-monster:
				compute ghost fleeing of N;
			rule succeeds.
The ghost winding rule is listed last in the ghost priority attack rules.

[To compute SelectionWaiting of (M - a monster):
	let C be a random worn pussy covering clothing;
	if the player is male and penis is lewdly exposed:
		say "POSSESSED";
	otherwise if the player is pee protected or there is a worn chastity cage or (the player is female and trap fetish is 1):
		say "bukkake";
	otherwise:
		say "The [M] ATTACHES ITSELF TO YOU".[The monster waits its turn.]]

To compute tripping attack of (M - a ghost):
	let C be a random worn displacable trousers;
	unless C is clothing, let C be a random worn knickers;
	if C is clothing:
		say "A pair of ghostly hands materialise next to the [M] and dive for your [printed name of C]!";
	otherwise:
		say "A pair of ghostly hands materialise next to the [M] and rush toward you!";
	let D be the tripping roll of M;
	if C is trousers, increase D by 5;
	if C is knickers, increase D by 2;
	if debugmode is 1, say "Player [dexterity of the player] | [D].5 Monster[line break]";
	if C is trousers, now C is crotch-displaced;
	if D >= the dexterity of the player:
		say "[MonsterTrippedFlav of M]";
		try kneeling;
	otherwise:
		say "[MonsterFailedTripFlav of M]".

To say MonsterTrippedFlav of (M - a ghost):
	let C be a random worn displacable trousers;
	unless C is clothing, let C be a random worn knickers;
	if C is trousers:
		say "They grab the waistband of your [printed name of C] and yank straight down, causing you to suddenly lose your balance and fall to the ground!";
	otherwise if C is clothing:
		say "They grab your [printed name of C] and yank straight down, pulling them off you and sweeping you off your feet in one fluid motion!";
		now C is in the location of the player;
	otherwise:
		say "They grab handfuls of your hair and yank straight down! You flail wildly [if the player is ankle bound]but you can't move your legs far enough apart to maintain your balance.  You[otherwise if the largeness of hair > 7]but your long hair gives the [M] too much extra leverage.  You[otherwise]and[end if] fall to the ground!".

To say MonsterFailedTripFlav of (M - a ghost):
	let C be a random worn displacable trousers;
	unless C is clothing, let C be a random worn knickers;
	if C is trousers:
		say "They grab the waistband of your [printed name of C] and yank straight down, but you manage to keep your balance.";
	otherwise if C is clothing:
		say "They grab your [printed name of C] and try to pull them down, but you manage to keep them up.";
	otherwise:
		say "You manage to get out of their way before they can grab you.".

To compute striking attack of (M - a ghost):[Only attacks places it could conceivably fuck]
	let B be a random body part;
	if B is belly, now B is thighs;
	if B is a fuckhole or B is penis, now B is hips;
	if B is hair, now B is face;
	if the accuracy roll of M > the dexterity of the player:
		say "[StrikingSuccessFlav of M on B]";
		compute M striking B;
	otherwise:	
		say "[StrikingFailureFlav of M on B]".

To say StrikingFlav of (M - a ghost) on (B - a body part):
	say "The [M] slams [if B is hips]your ass[otherwise if B is face]you in the face[otherwise]itself into your [printed name of B][end if]!";

To say StrikingSuccessFlav of (M - a ghost) on (B - a body part):
	say "[StrikingFlav of M on B]";
	say "Ouch!  That one hurt.".

To say StrikingFailureFlav of (M - a ghost) on (B - a body part):
	say "[StrikingFlav of M on B]";
	say "That slap wasn't too bad.".

To compute (C - a clothing) damaging (M - a ghost):[covers both spike bra and striped top]
	say "The spikes of your [printed name of C] leave visible, pulsing gaps in the [M]'s form for several seconds after its attack!";
	decrease the health of M by 2;
	if C is blessed, decrease the health of M by 2.

To compute (M - a ghost) striking (B - breasts):
	let C be a random worn top level covering blessed clothing;
	let P be a random worn breast covering protection clothing;
	let R be 0;
	if there is a worn santa corset:
		let R be a random number between 2 and 22;
		if R > the largeness of breasts:
			say "The brunt of the blow is absorbed by your [random worn santa corset]!";
		otherwise:
			BodyRuin 2;
	otherwise if there is a worn striped top and total-wasps > 50:
		say "The blow deflects off the shiny black carapace covering your breasts!"; [The ghost simply passes through a chainmail top, but it can't pass through something "part" of your skin.]
	otherwise if P is clothing:
		if a random number between the magic-modifier of P and 8 > 4, say "The [P] protects you from being properly injured by the attack!";
		otherwise now R is 1;
	otherwise:
		now R is 1;
	if R is 1:
		if C is clothing:
			say "The [M] seems to blur around the edges after its attack. It must have been hurt by the blessing on your [printed name of C]!";
			decrease the health of M by 2;
		BodyRuin 2;
	if C is spikey:
		compute C damaging M;
	otherwise if C is clothing and M is jismbodied ghost and bukkake fetish is 1:
		say "The [M] leaves some of itself behind on your [printed name of C]!";
		CumSoak a random number between 2 and 3 on C.

To compute (M - a ghost) striking (B - hips):
	let C be a random worn blessed skirted clothing;
	if C is nothing, now C is a random worn blessed top level protection clothing;
	let R be 0;
	let P be a random worn skirted protection clothing;
	if P is nothing, let P be a random worn crotch covering protection clothing;
	if P is clothing:
		if a random number between the magic-modifier of P and 8 > 4, say "The [P] protects you from being properly injured by the attack!";
		otherwise now R is 1;
	if R is 1:
		if C is clothing:
			say "The [M] seems to blur around the edges after its attack. It must have been hurt by the blessing on your [printed name of C]!";
			decrease the health of M by 2;
		BodyRuin 1;
	if C is clothing and M is jismbodied ghost and bukkake fetish is 1, CumSoak a random number between 2 and 3 on C.

To compute (M - a ghost) striking (B - arms):
	let R be 0;
	let P be a random worn arm covering clothing;
	if P is clothing and P is protection:
		if a random number between the magic-modifier of P and 8 > 4, say "The [P] protects you from being properly injured by the attack!";
	otherwise:
		if M is jismbodied ghost and P is clothing and P is blessed:
			say "The [M] seems to blur around the edges after its attack. It must have been hurt by the blessing on your [printed name of P]!";
			decrease the health of M by 2;
	if P is clothing and M is jismbodied ghost and bukkake fetish is 1, CumSoak a random number between 2 and 3 on P;
	BodyRuin R.
		
To compute (M - a ghost) striking (B - thighs):
	let R be 0;
	let P be a random worn leg covering clothing;
	if P is clothing and P is protection:
		if a random number between the magic-modifier of P and 8 > 4, say "The [P] protects you from being properly injured by the attack!";
		otherwise now R is 1;
	otherwise:
		if M is jismbodied ghost and P is clothing and P is blessed:
			say "The [M] seems to blur around the edges after its attack. It must have been hurt by the blessing on your [printed name of P]!";
			decrease the health of M by 2;
	if P is clothing and M is jismbodied ghost and bukkake fetish is 1, CumSoak a random number between 2 and 3 on P;
	BodyRuin R.

Definition: a ghost (called M) is damageable:
	if M is unphased, decide yes;
	if the wind-up of M > 0, decide yes;
	if attack-type is 1 and (there is a worn blessed equippable or there is a worn sword of purity), decide yes;
	if attack-type is 2 and there is a worn blessed trousers or there is a worn blessed stockings or (there is a worn blessed suspenders and there is worn stockings), decide yes;
	if attack-type is 3 and there is a worn blessed heels, decide yes;
	if the class of the player is cultist or the class of the player is priestess, decide yes;
	decide no.

To decide which number is the damage modifier of (M - a ghost):
	if M is not damageable, decide on (attack-damage * -1).

To say damage-flavour of (N - a number) on (M - a ghost):
	if N is 0 and M is not damageable:
		if attack-type is 1:
			say "[one of]Your [if there is a worn equippable][printed name of a random worn equippable][otherwise]hand[end if] passes right through it![or]Your attack passes right through it![or]Attacking it like this is useless![cycling]";
		otherwise if attack-type > 1:
			say "[one of]Your leg passes right through it![or]Your attack passes right through it![or]You won't get anywhere like this![cycling]";
	otherwise if N is 0:
		say "That didn't feel like it did anything at all.";
	otherwise if N is 1:
		say "That felt extremely weak, you doubt it hurt much at all.";
	otherwise if N is 2:
		say "That felt quite weak, but hopefully it hurt a bit.";
	otherwise if N < 5:
		say "The [M] blurs at the edges from your attack.  A respectable hit!";
	otherwise if N < 7:
		say "The [M] flinches from the hit, blurring at the edges.  A [if critical is 1][bold type]critical hit[roman type][otherwise]strong hit[end if]!";
	otherwise if N < 9:
		say "Wow, that one sent the [M] back a couple feet.  A super strong [if critical is 1][bold type]critical hit[roman type][otherwise]hit[end if]!";
	otherwise:
		say "POW!  Your attack is accompanied by a loud sound and sends the [M] flying across the room!  An almost impossibly strong [if critical is 1][bold type]critical hit[roman type][otherwise]hit[end if]!".

To compute damage of (M - a ghost):
	if the health of M > 0:
		if M is uninterested:
			if M is jismbodied ghost, say "The [M]'s slimy core begins to expand, slowly reforming itself into a very big and very erect floating [one of]penis[or]dick[at random], big enough to club you over the head.";
			otherwise say "The light emanating from the [M] flickers, and seems to bend around an unseen object at its core, slowly reforming it into a very long and very erect [manly-penis] right before your eyes";
			now M is interested;
			anger M;
		otherwise if the health of M is the maxhealth of M:
			say "[one of]Green fluid beads at its tip[or]Green fluid continues dripping from its tip[stopping]. It seems like all you've succeeded at is turning it on!";
			increase the bank of M by 10;
			anger M;
		otherwise if the wind-up of M > 0 and M is not jismbodied ghost:
			if M is ghostly tentacle:
				say "The [M] releases you instantly, shifting back out of the physical world as it recoils from your attack!";
				now the wind-up of M is 0;
				now M is phased;
			otherwise if a random number between 1 and 2 is 1:
				say "The [M] flickers after being sent back several feet. Looks like you interrupted it!";
				now the wind-up of M is 0;
			otherwise:
				say "The [M] seems completely undeterred by your attack!";
		otherwise:
			if the health of M > the maxhealth of M / 2, say "It seems completely undeterred by your attack!";
			otherwise say "Its glow is getting dimmer.";
	otherwise:
		compute death of M.

To compute unique death of (M - a ghost):
	say "You hear a terrible shriek and the [M] disappears behind a curtain of green flames.";
	let D be a random off-stage ectoplasm;
	if D is ectoplasm and (M is disembodied ghost or a random number between 1 and 3 is 1):
		now D is in the location of the player;
		say "You notice a green substance congealing on the floor below where it was floating.";
		compute autotaking D;
	destroy M;
	increase creepiness by the difficulty of M * 2.

[To compute desperate drinking to (M - a ghost):
	compute M entering mouth.]

Part 3 - Ghostly Tentacle

A ghostly tentacle is a kind of ghost. There is 1 ghostly tentacle. The printed name of a ghostly tentacle is "[if item described is in the location of the player][TQlink of item described][end if][input-style]phantom tentacle[shortcut-desc][roman type][if item described is in the location of the player][TQxlink of item described][verb-desc of item described][end if]". A ghostly tentacle has a number called holeCount. The holeCount of a ghostly tentacle is usually 0. Understand "phantom" as ghostly tentacle. The bank of a ghostly tentacle is usually 3. A ghostly tentacle is usually not father material.

To set up (M - a ghostly tentacle):
	reset M;
	now the monstersetup of M is 1;
	now the difficulty of M is 9;
	now the health of M is the maxhealth of M;
	now M is phased.

To decide which number is the maxhealth of (M - a ghostly tentacle):
	decide on 1 + (the difficulty of M * (1 + game difficulty)).

Definition: a ghostly tentacle (called M) is blocker:
	decide yes.	

To decide which number is the girth of (M - a ghostly tentacle):
	let G be 4;
	if the location of the player is mansion23, increase G by 1;
	if the class of the player is schoolgirl, increase G by 1;
	decide on G.

To compute perception of (M - a ghostly tentacle):
	now M is interested;
	let A be 0;
	repeat with N running through monsters in the location of the player:
		if the favour of N <= the aggro limit of N, now A is 1;
	if M is unfriendly or the bimbo of the player >= 15 or A is 1:
		say "The [M] slowly unfurls to its full, six foot length, revealing an underside full of giant, octopus-like suckers.";
		anger M;
	otherwise:
		say "The light cast by the [M] seems to change, and it begins to follow you around".

Section 1 - Ectoplasm

To compute ectoplasm to (M - a ghostly tentacle):
	let N be a random deep one;
	set up N;
	now N is in mansion23;
	drag to mansion23 by M;
	now M is grabbing the player;
	now the wind-up of M is 0;
	anger N;
	now the stance of the player is 1.

To say DragFlav of (M - a ghost) to (R - a room):
	say "A swirling portal opens up as the [M] drags you toward the ceiling, swallowing you whole!".
	
To say DragArrival of (M - a ghost) to (R - a room):
	say "The portal spits you out in the [R], where a [printed name of a random deep one in the location of the player] is there waiting for you, sporting a massive erection![if the player is upright][line break][bold type]You are now on your knees.[roman type][line break][end if]".	

This is the deep one express rule:
	if current-monster is ghostly tentacle and player is not immobile and the bank of current-monster > 15:
		let M be current-monster;
		now the wind-up of M is 1;
		now the bank of M is 0;
		say "The air seems to rumble as the [M] shifts fully into the corporeal world. It seizes you by the wrist!";
		now M is unphased;
		rule succeeds.
The deep one express rule is listed first in the ghost priority attack rules.

Check slapping ghostly tentacle:
	if the wind-up of the noun is 1 and there is a worn wrist bond and there is not a worn slap ready equippable, say "Your range of motion with your wrists bound together is too small for you to be able to hurt it!" instead.
Check kneeing ghostly tentacle:
	if the wind-up of the noun is 1, say "It has you by the wrist! You can't reach it with your leg!" instead.
Check kicking ghostly tentacle:
	if the wind-up of the noun is 1, say "It has you by the wrist! You can't reach it with your leg!" instead.

Section 2 - Tripping

To compute tripping attack of (M - a ghostly tentacle):
	let C be a random worn displacable trousers;
	unless C is clothing, let C be a random worn pussy protection knickers;
	if C is clothing:
		say "The [M] grabs the hem of your [printed name of C]!";
	otherwise:
		say "The [M] rears back and immediately rushes toward you!";
	let D be the tripping roll of M;
	if C is trousers, increase D by 4;
	if C is knickers, increase D by 5 - the armour of C;
	if debugmode is 1, say "Player [dexterity of the player] | [D].5 Monster[line break]";
	if C is trousers, now C is crotch-displaced;
	if D >= the dexterity of the player:
		say "[MonsterTrippedFlav of M]";
		unless C is knickers, try kneeling;
	otherwise:
		say "[MonsterFailedTripFlav of M]".

To say MonsterTrippedFlav of (M - a ghostly tentacle):
	let C be a random worn displacable trousers;
	unless C is clothing, let C be a random worn knickers;
	if C is trousers:
		say "It yanks straight down, causing you to lose your balance and fall to the ground!";
	otherwise if C is clothing:
		say "It tears them clean off!";
		destroy C;
	otherwise:
		say "It seizes your ankle and rips you off your feet!".

To say MonsterFailedTripFlav of (M - a ghostly tentacle):
	let C be a random worn displacable trousers;
	unless C is clothing, let C be a random worn knickers;
	if C is trousers:
		say "It yanks straight down, almost causing you to lose your balance as it exposes your [if there is a worn knickers][printed name of a random worn knickers][otherwise][genitals][end if]";
	otherwise if C is clothing:
		say "It pulls hard until it loses its grip, weakening the fabric!";
	otherwise:
		say "You manage to get out of the way before it can grab you!".


Ghost ends here.
